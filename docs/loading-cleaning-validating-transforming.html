<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Loading, Cleaning, Validating, Transforming | Quality of Location - developing a new pitch metric</title>
  <meta name="description" content="Chapter 2 Loading, Cleaning, Validating, Transforming | Quality of Location - developing a new pitch metric" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Loading, Cleaning, Validating, Transforming | Quality of Location - developing a new pitch metric" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Loading, Cleaning, Validating, Transforming | Quality of Location - developing a new pitch metric" />
  
  
  

<meta name="author" content="Doug Rose" />


<meta name="date" content="2023-12-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="example-model.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/tabwid-1.1.3/tabwid.css" rel="stylesheet" />
<script src="libs/tabwid-1.1.3/tabwid.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Pitch Location Quality Project</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#project-overview"><i class="fa fa-check"></i><b>1.1</b> Project Overview</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html"><i class="fa fa-check"></i><b>2</b> Loading, Cleaning, Validating, Transforming</a>
<ul>
<li class="chapter" data-level="2.1" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#loading-dataset"><i class="fa fa-check"></i><b>2.1</b> Loading Dataset</a></li>
<li class="chapter" data-level="2.2" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#explain-variables-of-interest"><i class="fa fa-check"></i><b>2.2</b> Explain Variables of Interest</a></li>
<li class="chapter" data-level="2.3" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#create-new-variables"><i class="fa fa-check"></i><b>2.3</b> Create New Variables</a></li>
<li class="chapter" data-level="2.4" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#validating-count-handedness-game-year"><i class="fa fa-check"></i><b>2.4</b> Validating Count, Handedness, Game Year</a></li>
<li class="chapter" data-level="2.5" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#remove-and-transform-event-values"><i class="fa fa-check"></i><b>2.5</b> Remove and Transform Event Values</a></li>
<li class="chapter" data-level="2.6" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#event-outcome-frequency-by-count"><i class="fa fa-check"></i><b>2.6</b> Event Outcome Frequency by Count</a></li>
<li class="chapter" data-level="2.7" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#average-delta-run-expectancy"><i class="fa fa-check"></i><b>2.7</b> Average Delta Run Expectancy</a></li>
<li class="chapter" data-level="2.8" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#join-lookup-table-to-data-set"><i class="fa fa-check"></i><b>2.8</b> Join Lookup Table to Data Set</a></li>
<li class="chapter" data-level="2.9" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#addressing-pitch-types"><i class="fa fa-check"></i><b>2.9</b> Addressing Pitch Types</a></li>
<li class="chapter" data-level="2.10" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#cleaning-pitch-locations"><i class="fa fa-check"></i><b>2.10</b> Cleaning Pitch Locations</a></li>
<li class="chapter" data-level="2.11" data-path="loading-cleaning-validating-transforming.html"><a href="loading-cleaning-validating-transforming.html#count-of-all-observations"><i class="fa fa-check"></i><b>2.11</b> Count of All Observations</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-model.html"><a href="example-model.html"><i class="fa fa-check"></i><b>3</b> Example Model</a>
<ul>
<li class="chapter" data-level="3.1" data-path="example-model.html"><a href="example-model.html#scatterplot-of-example-data"><i class="fa fa-check"></i><b>3.1</b> Scatterplot of Example Data</a></li>
<li class="chapter" data-level="3.2" data-path="example-model.html"><a href="example-model.html#scatterplot-of-example-data-filtered"><i class="fa fa-check"></i><b>3.2</b> Scatterplot of Example Data Filtered</a></li>
<li class="chapter" data-level="3.3" data-path="example-model.html"><a href="example-model.html#create-grid"><i class="fa fa-check"></i><b>3.3</b> Create Grid</a></li>
<li class="chapter" data-level="3.4" data-path="example-model.html"><a href="example-model.html#apply-game-results-to-grid"><i class="fa fa-check"></i><b>3.4</b> Apply Game Results to Grid</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>4</b> Functions</a>
<ul>
<li class="chapter" data-level="4.1" data-path="functions.html"><a href="functions.html#function-1"><i class="fa fa-check"></i><b>4.1</b> Function 1</a></li>
<li class="chapter" data-level="4.2" data-path="functions.html"><a href="functions.html#function-2"><i class="fa fa-check"></i><b>4.2</b> Function 2</a></li>
<li class="chapter" data-level="4.3" data-path="functions.html"><a href="functions.html#function-3"><i class="fa fa-check"></i><b>4.3</b> Function 3</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="applying-functions.html"><a href="applying-functions.html"><i class="fa fa-check"></i><b>5</b> Applying Functions</a>
<ul>
<li class="chapter" data-level="5.1" data-path="applying-functions.html"><a href="applying-functions.html#create-data-frames"><i class="fa fa-check"></i><b>5.1</b> Create Data Frames</a></li>
<li class="chapter" data-level="5.2" data-path="applying-functions.html"><a href="applying-functions.html#create-plots"><i class="fa fa-check"></i><b>5.2</b> Create Plots</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="visualizing-resulting-plots.html"><a href="visualizing-resulting-plots.html"><i class="fa fa-check"></i><b>6</b> Visualizing Resulting Plots</a>
<ul>
<li class="chapter" data-level="6.1" data-path="visualizing-resulting-plots.html"><a href="visualizing-resulting-plots.html#plot-outputs"><i class="fa fa-check"></i><b>6.1</b> Plot Outputs</a></li>
<li class="chapter" data-level="6.2" data-path="visualizing-resulting-plots.html"><a href="visualizing-resulting-plots.html#compile-results-into-1-lookup-table"><i class="fa fa-check"></i><b>6.2</b> Compile Results into 1 Lookup Table</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="applying-results-to-2023-season.html"><a href="applying-results-to-2023-season.html"><i class="fa fa-check"></i><b>7</b> Applying Results to 2023 Season</a>
<ul>
<li class="chapter" data-level="7.1" data-path="applying-results-to-2023-season.html"><a href="applying-results-to-2023-season.html#cleaning-2023-dataset"><i class="fa fa-check"></i><b>7.1</b> Cleaning 2023 Dataset</a></li>
<li class="chapter" data-level="7.2" data-path="applying-results-to-2023-season.html"><a href="applying-results-to-2023-season.html#location-quality-by-pitch-type"><i class="fa fa-check"></i><b>7.2</b> Location Quality by Pitch Type</a></li>
<li class="chapter" data-level="7.3" data-path="applying-results-to-2023-season.html"><a href="applying-results-to-2023-season.html#location-quality-by-count"><i class="fa fa-check"></i><b>7.3</b> Location Quality by Count</a></li>
<li class="chapter" data-level="7.4" data-path="applying-results-to-2023-season.html"><a href="applying-results-to-2023-season.html#final-cleaning"><i class="fa fa-check"></i><b>7.4</b> Final Cleaning</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="shiny-dashbaord.html"><a href="shiny-dashbaord.html"><i class="fa fa-check"></i><b>8</b> Shiny Dashbaord</a></li>
<li class="chapter" data-level="9" data-path="project-takeaways-and-limitations.html"><a href="project-takeaways-and-limitations.html"><i class="fa fa-check"></i><b>9</b> Project Takeaways and Limitations</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Quality of Location - developing a new pitch metric</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="loading-cleaning-validating-transforming" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Loading, Cleaning, Validating, Transforming<a href="loading-cleaning-validating-transforming.html#loading-cleaning-validating-transforming" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="loading-dataset" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Loading Dataset<a href="loading-cleaning-validating-transforming.html#loading-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll start by loading in Statcast data from the 2014 MLB season through the 2023 season, hosted on the baseball savant website. Each records represents a single pitch and every single pitch contains a wealth of information (93 fields). This code reads in each years worth of pitches (roughly 710,000 pitches per year) stored locally. To reproduce the following scripts for the rest of the project, each season’s worth of data will need to be scraped and stored with the scripts included in the github folder.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="loading-cleaning-validating-transforming.html#cb1-1" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="loading-cleaning-validating-transforming.html#cb2-1" tabindex="-1"></a>mlbraw2014 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2014.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-2"><a href="loading-cleaning-validating-transforming.html#cb2-2" tabindex="-1"></a>mlbraw2015 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2015.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-3"><a href="loading-cleaning-validating-transforming.html#cb2-3" tabindex="-1"></a>mlbraw2016 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2016.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-4"><a href="loading-cleaning-validating-transforming.html#cb2-4" tabindex="-1"></a>mlbraw2017 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2017.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-5"><a href="loading-cleaning-validating-transforming.html#cb2-5" tabindex="-1"></a>mlbraw2018 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2018.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-6"><a href="loading-cleaning-validating-transforming.html#cb2-6" tabindex="-1"></a>mlbraw2019 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2019.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-7"><a href="loading-cleaning-validating-transforming.html#cb2-7" tabindex="-1"></a>mlbraw2020 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2020.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-8"><a href="loading-cleaning-validating-transforming.html#cb2-8" tabindex="-1"></a>mlbraw2021 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2021.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-9"><a href="loading-cleaning-validating-transforming.html#cb2-9" tabindex="-1"></a>mlbraw2022 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2022.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span>
<span id="cb2-10"><a href="loading-cleaning-validating-transforming.html#cb2-10" tabindex="-1"></a>mlbraw2023 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;/Users/dougrose/Desktop/location/raw_statcast/mlbraw2023.csv&quot;</span>,<span class="at">show_col_types=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">suppressMessages</span>()</span></code></pre></div>
<p>Format the game_date column to ensure all years have the same format.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="loading-cleaning-validating-transforming.html#cb3-1" tabindex="-1"></a>mlbraw2014<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2014<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-2"><a href="loading-cleaning-validating-transforming.html#cb3-2" tabindex="-1"></a>mlbraw2015<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2015<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-3"><a href="loading-cleaning-validating-transforming.html#cb3-3" tabindex="-1"></a>mlbraw2016<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2016<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-4"><a href="loading-cleaning-validating-transforming.html#cb3-4" tabindex="-1"></a>mlbraw2017<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2017<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-5"><a href="loading-cleaning-validating-transforming.html#cb3-5" tabindex="-1"></a>mlbraw2018<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2018<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-6"><a href="loading-cleaning-validating-transforming.html#cb3-6" tabindex="-1"></a>mlbraw2019<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2019<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-7"><a href="loading-cleaning-validating-transforming.html#cb3-7" tabindex="-1"></a>mlbraw2020<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2020<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-8"><a href="loading-cleaning-validating-transforming.html#cb3-8" tabindex="-1"></a>mlbraw2021<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2021<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-9"><a href="loading-cleaning-validating-transforming.html#cb3-9" tabindex="-1"></a>mlbraw2022<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2022<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span>
<span id="cb3-10"><a href="loading-cleaning-validating-transforming.html#cb3-10" tabindex="-1"></a>mlbraw2023<span class="sc">$</span>game_date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(mlbraw2023<span class="sc">$</span>game_date, <span class="at">format=</span><span class="st">&quot;%m/%d/%y&quot;</span>)</span></code></pre></div>
<p>Create a single data frame containing all years and remove individual year data frames.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="loading-cleaning-validating-transforming.html#cb4-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw2014, mlbraw2015, mlbraw2016, mlbraw2017, mlbraw2018, </span>
<span id="cb4-2"><a href="loading-cleaning-validating-transforming.html#cb4-2" tabindex="-1"></a>                    mlbraw2019, mlbraw2020, mlbraw2021, mlbraw2022, mlbraw2023)</span>
<span id="cb4-3"><a href="loading-cleaning-validating-transforming.html#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="loading-cleaning-validating-transforming.html#cb4-4" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(game_year), <span class="fu">desc</span>(game_date), game_pk)</span>
<span id="cb4-5"><a href="loading-cleaning-validating-transforming.html#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="loading-cleaning-validating-transforming.html#cb4-6" tabindex="-1"></a><span class="fu">rm</span>(mlbraw2014, mlbraw2015, mlbraw2016, mlbraw2017, mlbraw2018, </span>
<span id="cb4-7"><a href="loading-cleaning-validating-transforming.html#cb4-7" tabindex="-1"></a>   mlbraw2019, mlbraw2020, mlbraw2021, mlbraw2022, mlbraw2023)</span></code></pre></div>
</div>
<div id="explain-variables-of-interest" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Explain Variables of Interest<a href="loading-cleaning-validating-transforming.html#explain-variables-of-interest" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>With a single data frame containing all MLB pitches the past 10 years, I’ll start to limit it to only the variables relevant to the project.</p>
<ul>
<li><p>game_year: simply the year the game was played</p></li>
<li><p>pitch_name: name of the pitch type thrown by the pitcher (Fastball, Curveball etc.)</p></li>
<li><p>pitch_type: abbreviated pitch_name (FF represents a 4-Seam Fastball)</p></li>
<li><p>p_throws: does the pitcher throw right-handed or left-handed</p></li>
<li><p>stand: does the batter stand right-handed or left-handed</p></li>
<li><p>balls: how many balls were in the count before the pitch of record</p></li>
<li><p>strikes: how many strikes were in the count before the pitch of record</p></li>
<li><p>events: what event took place as a result of this pitch (single, walk, hit by pitch, home run)</p></li>
<li><p>plate_x: the horizontal location of the pitch as its crossing the plate, measured in feet away from the center of the plate</p></li>
<li><p>plate_z: the vertical location of the pitch as its crossing the plate, measured in feet off the ground</p></li>
</ul>
</div>
<div id="create-new-variables" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Create New Variables<a href="loading-cleaning-validating-transforming.html#create-new-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The final data set will be a cleaned version of <em>mlbraw</em> containing columns: <em>year, p_type, count, hand, events, plate_x, plate_z, lw</em>.</p>
<p>First I’ll start by creating single column detailing the outcome of an individual pitch (each row). The <strong>events</strong> column only displays a value if that pitch leads to a batter outcome (walk, single, etc.). NA values represent pitches made that don’t end the at-bats, like balls and strikes. So this new <strong>events</strong> column details the result of every pitch.</p>
<p>Also, I’ll want to combine the <strong>strikes</strong> and <strong>balls</strong> values creating a new <strong>count</strong> column. This represents the batter’s count state each pitch occurs in.</p>
<p>The <strong>stand</strong> column specifies whether the batter hits right-handed or left-handed. The <strong>p_throws</strong> column specifies whether the pitcher throws right-handed or left-handed. For the purposes or this project I’m interested in the combination of the batter/pitcher handedness. The new column <strong>hand</strong> details this.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="loading-cleaning-validating-transforming.html#cb5-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="loading-cleaning-validating-transforming.html#cb5-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">events =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(events) <span class="sc">|</span> events <span class="sc">==</span> <span class="st">&quot;&quot;</span>, type, events)) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="loading-cleaning-validating-transforming.html#cb5-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">events =</span> <span class="fu">if_else</span>(events <span class="sc">==</span> <span class="st">&quot;B&quot;</span>, <span class="st">&quot;ball&quot;</span>, </span>
<span id="cb5-4"><a href="loading-cleaning-validating-transforming.html#cb5-4" tabindex="-1"></a>                          <span class="fu">if_else</span>(events <span class="sc">==</span> <span class="st">&quot;S&quot;</span>, <span class="st">&quot;strike&quot;</span>, events))) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="loading-cleaning-validating-transforming.html#cb5-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">paste</span>(balls, strikes, <span class="at">sep=</span><span class="st">&quot;-&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-6"><a href="loading-cleaning-validating-transforming.html#cb5-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hand =</span> <span class="fu">paste</span>(p_throws, stand, <span class="at">sep =</span> <span class="st">&quot;v&quot;</span>))</span>
<span id="cb5-7"><a href="loading-cleaning-validating-transforming.html#cb5-7" tabindex="-1"></a></span>
<span id="cb5-8"><a href="loading-cleaning-validating-transforming.html#cb5-8" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">select</span>(game_year, hand, count, pitch_type, pitch_name, </span>
<span id="cb5-9"><a href="loading-cleaning-validating-transforming.html#cb5-9" tabindex="-1"></a>                            events, plate_x, plate_z, delta_run_exp)</span></code></pre></div>
<p>A batter’s count can only be one of 12 possible counts so I’ll filter the data removing impossible counts. And also filter out impossible events in particular counts. (ex. A batter can’t draw a walk in a 2-2 count)</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="loading-cleaning-validating-transforming.html#cb6-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb6-2"><a href="loading-cleaning-validating-transforming.html#cb6-2" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0-0&quot;</span>,<span class="st">&quot;0-1&quot;</span>,<span class="st">&quot;0-2&quot;</span>,<span class="st">&quot;1-0&quot;</span>,<span class="st">&quot;1-1&quot;</span>,<span class="st">&quot;1-2&quot;</span>,</span>
<span id="cb6-3"><a href="loading-cleaning-validating-transforming.html#cb6-3" tabindex="-1"></a>                      <span class="st">&quot;2-0&quot;</span>,<span class="st">&quot;2-1&quot;</span>,<span class="st">&quot;2-2&quot;</span>,<span class="st">&quot;3-0&quot;</span>,<span class="st">&quot;3-1&quot;</span>,<span class="st">&quot;3-2&quot;</span>))</span>
<span id="cb6-4"><a href="loading-cleaning-validating-transforming.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="loading-cleaning-validating-transforming.html#cb6-5" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="loading-cleaning-validating-transforming.html#cb6-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(count <span class="sc">==</span> <span class="st">&quot;3-2&quot;</span> <span class="sc">&amp;</span> events <span class="sc">==</span> <span class="st">&quot;ball&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="loading-cleaning-validating-transforming.html#cb6-7" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(count <span class="sc">==</span> <span class="st">&quot;3-1&quot;</span> <span class="sc">&amp;</span> events <span class="sc">==</span> <span class="st">&quot;ball&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-8"><a href="loading-cleaning-validating-transforming.html#cb6-8" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(count <span class="sc">==</span> <span class="st">&quot;2-2&quot;</span> <span class="sc">&amp;</span> events <span class="sc">==</span> <span class="st">&quot;walk&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb6-9"><a href="loading-cleaning-validating-transforming.html#cb6-9" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(count <span class="sc">==</span> <span class="st">&quot;2-1&quot;</span> <span class="sc">&amp;</span> events <span class="sc">==</span> <span class="st">&quot;walk&quot;</span>))</span></code></pre></div>
<p>Change the data type of these variables to factors limiting the possible values and setting orders.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="loading-cleaning-validating-transforming.html#cb7-1" tabindex="-1"></a>mlbraw<span class="sc">$</span>count <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="loading-cleaning-validating-transforming.html#cb7-2" tabindex="-1"></a>  <span class="fu">factor</span>(mlbraw<span class="sc">$</span>count, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;0-0&quot;</span>,<span class="st">&quot;0-1&quot;</span>,<span class="st">&quot;0-2&quot;</span>,<span class="st">&quot;1-0&quot;</span>,<span class="st">&quot;1-1&quot;</span>,<span class="st">&quot;1-2&quot;</span>,</span>
<span id="cb7-3"><a href="loading-cleaning-validating-transforming.html#cb7-3" tabindex="-1"></a>                                <span class="st">&quot;2-0&quot;</span>,<span class="st">&quot;2-1&quot;</span>,<span class="st">&quot;2-2&quot;</span>,<span class="st">&quot;3-0&quot;</span>,<span class="st">&quot;3-1&quot;</span>,<span class="st">&quot;3-2&quot;</span>))</span>
<span id="cb7-4"><a href="loading-cleaning-validating-transforming.html#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="loading-cleaning-validating-transforming.html#cb7-5" tabindex="-1"></a>mlbraw<span class="sc">$</span>hand <span class="ot">&lt;-</span> <span class="fu">factor</span>(mlbraw<span class="sc">$</span>hand, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;RvR&quot;</span>, <span class="st">&quot;RvL&quot;</span>, <span class="st">&quot;LvR&quot;</span>, <span class="st">&quot;LvL&quot;</span>))</span>
<span id="cb7-6"><a href="loading-cleaning-validating-transforming.html#cb7-6" tabindex="-1"></a>mlbraw<span class="sc">$</span>game_year <span class="ot">&lt;-</span> <span class="fu">factor</span>(mlbraw<span class="sc">$</span>game_year, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;2014&quot;</span>,<span class="st">&quot;2015&quot;</span>,<span class="st">&quot;2016&quot;</span>,<span class="st">&quot;2017&quot;</span>,</span>
<span id="cb7-7"><a href="loading-cleaning-validating-transforming.html#cb7-7" tabindex="-1"></a>                                                      <span class="st">&quot;2018&quot;</span>,<span class="st">&quot;2019&quot;</span>,<span class="st">&quot;2020&quot;</span>,<span class="st">&quot;2021&quot;</span>,</span>
<span id="cb7-8"><a href="loading-cleaning-validating-transforming.html#cb7-8" tabindex="-1"></a>                                                      <span class="st">&quot;2022&quot;</span>,<span class="st">&quot;2023&quot;</span>))</span></code></pre></div>
<p>Finally, I’ll remove rows with NA values in our columns of interest.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="loading-cleaning-validating-transforming.html#cb8-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="loading-cleaning-validating-transforming.html#cb8-2" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(game_year), <span class="sc">!</span><span class="fu">is.na</span>(hand), <span class="sc">!</span><span class="fu">is.na</span>(count), </span>
<span id="cb8-3"><a href="loading-cleaning-validating-transforming.html#cb8-3" tabindex="-1"></a>           <span class="sc">!</span><span class="fu">is.na</span>(pitch_type), <span class="sc">!</span><span class="fu">is.na</span>(pitch_name), <span class="sc">!</span><span class="fu">is.na</span>(events), </span>
<span id="cb8-4"><a href="loading-cleaning-validating-transforming.html#cb8-4" tabindex="-1"></a>           <span class="sc">!</span><span class="fu">is.na</span>(plate_x), <span class="sc">!</span><span class="fu">is.na</span>(plate_z), <span class="sc">!</span><span class="fu">is.na</span>(delta_run_exp))</span></code></pre></div>
</div>
<div id="validating-count-handedness-game-year" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Validating Count, Handedness, Game Year<a href="loading-cleaning-validating-transforming.html#validating-count-handedness-game-year" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="loading-cleaning-validating-transforming.html#cb9-1" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(count) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="loading-cleaning-validating-transforming.html#cb9-2" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p=</span> n<span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb9-3"><a href="loading-cleaning-validating-transforming.html#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="loading-cleaning-validating-transforming.html#cb9-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot1, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">y=</span><span class="fu">fct_rev</span>(count)))<span class="sc">+</span></span>
<span id="cb9-5"><a href="loading-cleaning-validating-transforming.html#cb9-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;steelblue3&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-6"><a href="loading-cleaning-validating-transforming.html#cb9-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(p,<span class="dv">2</span>), <span class="st">&quot;%&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb9-7"><a href="loading-cleaning-validating-transforming.html#cb9-7" tabindex="-1"></a>        <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-8"><a href="loading-cleaning-validating-transforming.html#cb9-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Batter Count distribution </span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">+</span></span>
<span id="cb9-9"><a href="loading-cleaning-validating-transforming.html#cb9-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb9-10"><a href="loading-cleaning-validating-transforming.html#cb9-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>),</span>
<span id="cb9-11"><a href="loading-cleaning-validating-transforming.html#cb9-11" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb9-12"><a href="loading-cleaning-validating-transforming.html#cb9-12" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-13"><a href="loading-cleaning-validating-transforming.html#cb9-13" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb9-14"><a href="loading-cleaning-validating-transforming.html#cb9-14" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-15"><a href="loading-cleaning-validating-transforming.html#cb9-15" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-16"><a href="loading-cleaning-validating-transforming.html#cb9-16" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb9-17"><a href="loading-cleaning-validating-transforming.html#cb9-17" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb9-18"><a href="loading-cleaning-validating-transforming.html#cb9-18" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb9-19"><a href="loading-cleaning-validating-transforming.html#cb9-19" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.27</span>)<span class="sc">+</span></span>
<span id="cb9-20"><a href="loading-cleaning-validating-transforming.html#cb9-20" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.27</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/hitter%20count%20distribution-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
<p>The graph above shows the distribution of batter counts. Here I can start to get an idea of how much data there is to work with to build a location metric. 0-0 counts are well accounted for making up 26% of all pitches, while pitches in 3 ball counts are more scarce.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="loading-cleaning-validating-transforming.html#cb10-1" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(hand) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-2"><a href="loading-cleaning-validating-transforming.html#cb10-2" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p=</span> n<span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb10-3"><a href="loading-cleaning-validating-transforming.html#cb10-3" tabindex="-1"></a>  </span>
<span id="cb10-4"><a href="loading-cleaning-validating-transforming.html#cb10-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot2, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">y=</span><span class="fu">reorder</span>(hand,p)))<span class="sc">+</span></span>
<span id="cb10-5"><a href="loading-cleaning-validating-transforming.html#cb10-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;steelblue3&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="loading-cleaning-validating-transforming.html#cb10-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(p,<span class="dv">2</span>), <span class="st">&quot;%&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb10-7"><a href="loading-cleaning-validating-transforming.html#cb10-7" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.3</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)<span class="sc">+</span></span>
<span id="cb10-8"><a href="loading-cleaning-validating-transforming.html#cb10-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Pitcher and Batter Handedness distribution </span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-9"><a href="loading-cleaning-validating-transforming.html#cb10-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb10-10"><a href="loading-cleaning-validating-transforming.html#cb10-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>),</span>
<span id="cb10-11"><a href="loading-cleaning-validating-transforming.html#cb10-11" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb10-12"><a href="loading-cleaning-validating-transforming.html#cb10-12" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-13"><a href="loading-cleaning-validating-transforming.html#cb10-13" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-14"><a href="loading-cleaning-validating-transforming.html#cb10-14" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-15"><a href="loading-cleaning-validating-transforming.html#cb10-15" tabindex="-1"></a>        <span class="co">#axis.text.x = element_blank(),</span></span>
<span id="cb10-16"><a href="loading-cleaning-validating-transforming.html#cb10-16" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb10-17"><a href="loading-cleaning-validating-transforming.html#cb10-17" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb10-18"><a href="loading-cleaning-validating-transforming.html#cb10-18" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb10-19"><a href="loading-cleaning-validating-transforming.html#cb10-19" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.43</span>)<span class="sc">+</span></span>
<span id="cb10-20"><a href="loading-cleaning-validating-transforming.html#cb10-20" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/handedness%20distribution-1.png" width="768" style="display: block; margin: auto auto auto 0;" /></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="loading-cleaning-validating-transforming.html#cb11-1" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(game_year) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="loading-cleaning-validating-transforming.html#cb11-2" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p=</span> n<span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>n)</span>
<span id="cb11-3"><a href="loading-cleaning-validating-transforming.html#cb11-3" tabindex="-1"></a>  </span>
<span id="cb11-4"><a href="loading-cleaning-validating-transforming.html#cb11-4" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>plot3, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">y=</span>game_year))<span class="sc">+</span></span>
<span id="cb11-5"><a href="loading-cleaning-validating-transforming.html#cb11-5" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;steelblue3&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-6"><a href="loading-cleaning-validating-transforming.html#cb11-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(p,<span class="dv">2</span>), <span class="st">&quot;%&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb11-7"><a href="loading-cleaning-validating-transforming.html#cb11-7" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.3</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)<span class="sc">+</span></span>
<span id="cb11-8"><a href="loading-cleaning-validating-transforming.html#cb11-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Pitcher and Batter Handedness distribution </span><span class="sc">\n</span><span class="st">&quot;</span>) <span class="sc">+</span></span>
<span id="cb11-9"><a href="loading-cleaning-validating-transforming.html#cb11-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb11-10"><a href="loading-cleaning-validating-transforming.html#cb11-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>),</span>
<span id="cb11-11"><a href="loading-cleaning-validating-transforming.html#cb11-11" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb11-12"><a href="loading-cleaning-validating-transforming.html#cb11-12" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-13"><a href="loading-cleaning-validating-transforming.html#cb11-13" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-14"><a href="loading-cleaning-validating-transforming.html#cb11-14" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-15"><a href="loading-cleaning-validating-transforming.html#cb11-15" tabindex="-1"></a>        <span class="co">#axis.text.x = element_blank(),</span></span>
<span id="cb11-16"><a href="loading-cleaning-validating-transforming.html#cb11-16" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb11-17"><a href="loading-cleaning-validating-transforming.html#cb11-17" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb11-18"><a href="loading-cleaning-validating-transforming.html#cb11-18" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb11-19"><a href="loading-cleaning-validating-transforming.html#cb11-19" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.43</span>)<span class="sc">+</span></span>
<span id="cb11-20"><a href="loading-cleaning-validating-transforming.html#cb11-20" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/game_year%20distribution-1.png" width="768" style="display: block; margin: auto auto auto 0;" /></p>
<p>As expected, the data set is split pretty evenly by game year. Teams plays 162 regular season games per year, giving me about 2400 games worth of data per year. The only exception is the 60 game 2020 season due to COVID-19.</p>
</div>
<div id="remove-and-transform-event-values" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> Remove and Transform Event Values<a href="loading-cleaning-validating-transforming.html#remove-and-transform-event-values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The events column may contain some other game event description not related to the pitch being thrown. If the pitcher picks off the runner leading off first base, that event will show up as a record in the data set. If a coach argues in between pitches and gets ejected from the game, that event will show up as a record in the data set. For the purpose of this project, I am only concerned with pitches thrown, and specifically competitive pitches where legitimate attempts are made by the batter. This is a somewhat subjective criteria, but I’ve chosen to limit the data set and remove the following events.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="loading-cleaning-validating-transforming.html#cb12-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="loading-cleaning-validating-transforming.html#cb12-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(events <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;catcher_interf&quot;</span>,<span class="st">&quot;caught_stealing_2b&quot;</span>,<span class="st">&quot;caught_stealing_3b&quot;</span>,</span>
<span id="cb12-3"><a href="loading-cleaning-validating-transforming.html#cb12-3" tabindex="-1"></a>                         <span class="st">&quot;caught_stealing_home&quot;</span>,<span class="st">&quot;ejection&quot;</span>,<span class="st">&quot;field_error&quot;</span>,<span class="st">&quot;game_advisory&quot;</span>,</span>
<span id="cb12-4"><a href="loading-cleaning-validating-transforming.html#cb12-4" tabindex="-1"></a>                         <span class="st">&quot;intent_walk&quot;</span>,<span class="st">&quot;other_out&quot;</span>,<span class="st">&quot;passed_ball&quot;</span>,<span class="st">&quot;pickoff_1b&quot;</span>,</span>
<span id="cb12-5"><a href="loading-cleaning-validating-transforming.html#cb12-5" tabindex="-1"></a>                         <span class="st">&quot;pickoff_2b&quot;</span>,<span class="st">&quot;pickoff_3b&quot;</span>,<span class="st">&quot;pickoff_caught_stealing_2b&quot;</span>,</span>
<span id="cb12-6"><a href="loading-cleaning-validating-transforming.html#cb12-6" tabindex="-1"></a>                         <span class="st">&quot;pickoff_caught_stealing_3b&quot;</span>,<span class="st">&quot;pickoff_caught_stealing_home&quot;</span>,</span>
<span id="cb12-7"><a href="loading-cleaning-validating-transforming.html#cb12-7" tabindex="-1"></a>                         <span class="st">&quot;pickoff_error_2b&quot;</span>,<span class="st">&quot;pickoff_error_3b&quot;</span>,<span class="st">&quot;pitchout&quot;</span>,</span>
<span id="cb12-8"><a href="loading-cleaning-validating-transforming.html#cb12-8" tabindex="-1"></a>                         <span class="st">&quot;runner_double_play&quot;</span>,<span class="st">&quot;stolen_base_2b&quot;</span>,<span class="st">&quot;stolen_base_3b&quot;</span>,</span>
<span id="cb12-9"><a href="loading-cleaning-validating-transforming.html#cb12-9" tabindex="-1"></a>                         <span class="st">&quot;stolen_base_3b&quot;</span>,<span class="st">&quot;stolen_base_home&quot;</span>)))</span></code></pre></div>
<p>Wild pitches are showing up as a unique events in the data set, when in reality they are just balls thrown extremely away from the strike zone. I’ve changed the <strong>wild_pitch</strong> values to <strong>ball</strong> or <strong>walk</strong> depending on the count it was thrown in.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="loading-cleaning-validating-transforming.html#cb13-1" tabindex="-1"></a>mlbraw_a <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="loading-cleaning-validating-transforming.html#cb13-2" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0-0&quot;</span>,<span class="st">&quot;0-1&quot;</span>,<span class="st">&quot;1-0&quot;</span>,<span class="st">&quot;1-1&quot;</span>,<span class="st">&quot;2-0&quot;</span>,<span class="st">&quot;2-1&quot;</span>,<span class="st">&quot;0-2&quot;</span>,<span class="st">&quot;1-2&quot;</span>,<span class="st">&quot;2-2&quot;</span>))</span>
<span id="cb13-3"><a href="loading-cleaning-validating-transforming.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="loading-cleaning-validating-transforming.html#cb13-4" tabindex="-1"></a>mlbraw_b <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="loading-cleaning-validating-transforming.html#cb13-5" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;3-0&quot;</span>,<span class="st">&quot;3-1&quot;</span>,<span class="st">&quot;3-2&quot;</span>))</span>
<span id="cb13-6"><a href="loading-cleaning-validating-transforming.html#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="loading-cleaning-validating-transforming.html#cb13-7" tabindex="-1"></a>mlbraw_a <span class="ot">&lt;-</span> mlbraw_a <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="loading-cleaning-validating-transforming.html#cb13-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">events =</span> <span class="fu">if_else</span>(events <span class="sc">==</span><span class="st">&quot;wild_pitch&quot;</span>, <span class="st">&quot;ball&quot;</span>, events))</span>
<span id="cb13-9"><a href="loading-cleaning-validating-transforming.html#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="loading-cleaning-validating-transforming.html#cb13-10" tabindex="-1"></a>mlbraw_b <span class="ot">&lt;-</span> mlbraw_b <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href="loading-cleaning-validating-transforming.html#cb13-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">events =</span> <span class="fu">if_else</span>(events <span class="sc">==</span><span class="st">&quot;wild_pitch&quot;</span>, <span class="st">&quot;walk&quot;</span>, events))</span>
<span id="cb13-12"><a href="loading-cleaning-validating-transforming.html#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="loading-cleaning-validating-transforming.html#cb13-13" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw_a, mlbraw_b) <span class="sc">%&gt;%</span> </span>
<span id="cb13-14"><a href="loading-cleaning-validating-transforming.html#cb13-14" tabindex="-1"></a>  <span class="fu">arrange</span>(game_year, count, events)</span>
<span id="cb13-15"><a href="loading-cleaning-validating-transforming.html#cb13-15" tabindex="-1"></a></span>
<span id="cb13-16"><a href="loading-cleaning-validating-transforming.html#cb13-16" tabindex="-1"></a><span class="fu">rm</span>(mlbraw_a, mlbraw_b)</span></code></pre></div>
<p>Similarly, foul balls in two strike counts should be labeled <strong>foul</strong> rather than strike. A strike thrown in a 0-2, 1-2, 2-2, or 3-2 count would actually be a strikeout. So whenever a batter fouls a ball off in a these counts, I’ll given the event a new value<strong>: foul</strong>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="loading-cleaning-validating-transforming.html#cb14-1" tabindex="-1"></a>mlbraw_a <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(count <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0-2&quot;</span>,<span class="st">&quot;1-2&quot;</span>,<span class="st">&quot;2-2&quot;</span>,<span class="st">&quot;3-2&quot;</span>))</span>
<span id="cb14-2"><a href="loading-cleaning-validating-transforming.html#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="loading-cleaning-validating-transforming.html#cb14-3" tabindex="-1"></a>mlbraw_b <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>(count <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0-2&quot;</span>,<span class="st">&quot;1-2&quot;</span>,<span class="st">&quot;2-2&quot;</span>,<span class="st">&quot;3-2&quot;</span>)))</span>
<span id="cb14-4"><a href="loading-cleaning-validating-transforming.html#cb14-4" tabindex="-1"></a></span>
<span id="cb14-5"><a href="loading-cleaning-validating-transforming.html#cb14-5" tabindex="-1"></a>mlbraw_a <span class="ot">&lt;-</span> mlbraw_a <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">events =</span> <span class="fu">if_else</span>(events <span class="sc">==</span> <span class="st">&quot;strike&quot;</span>, <span class="st">&quot;foul&quot;</span>, events))</span>
<span id="cb14-6"><a href="loading-cleaning-validating-transforming.html#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="loading-cleaning-validating-transforming.html#cb14-7" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw_a, mlbraw_b)</span>
<span id="cb14-8"><a href="loading-cleaning-validating-transforming.html#cb14-8" tabindex="-1"></a></span>
<span id="cb14-9"><a href="loading-cleaning-validating-transforming.html#cb14-9" tabindex="-1"></a><span class="fu">rm</span>(mlbraw_a, mlbraw_b)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="loading-cleaning-validating-transforming.html#cb15-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">events=</span><span class="fu">if_else</span>(events<span class="sc">==</span><span class="st">&quot;home_run&quot;</span>,<span class="st">&quot;hr&quot;</span>,events))</span></code></pre></div>
<p>I’ll separate the event values as non_outs and outs for future purposes. And check to make sure these are the distinct events values contained in the main data set.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="loading-cleaning-validating-transforming.html#cb16-1" tabindex="-1"></a>non_outs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;ball&quot;</span>,<span class="st">&quot;double&quot;</span>,<span class="st">&quot;hit_by_pitch&quot;</span>,<span class="st">&quot;hr&quot;</span>, <span class="st">&quot;foul&quot;</span>,<span class="st">&quot;single&quot;</span>,</span>
<span id="cb16-2"><a href="loading-cleaning-validating-transforming.html#cb16-2" tabindex="-1"></a>              <span class="st">&quot;strike&quot;</span>,<span class="st">&quot;triple&quot;</span>,<span class="st">&quot;walk&quot;</span>,<span class="st">&quot;wild_pitch&quot;</span>)</span>
<span id="cb16-3"><a href="loading-cleaning-validating-transforming.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="loading-cleaning-validating-transforming.html#cb16-4" tabindex="-1"></a>outs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;double_play&quot;</span>,<span class="st">&quot;field_out&quot;</span>,<span class="st">&quot;fielders_choice&quot;</span>,<span class="st">&quot;fielders_choice_out&quot;</span>,</span>
<span id="cb16-5"><a href="loading-cleaning-validating-transforming.html#cb16-5" tabindex="-1"></a>          <span class="st">&quot;force_out&quot;</span>, <span class="st">&quot;grounded_into_double_play&quot;</span>,<span class="st">&quot;fielders_choice_out&quot;</span>,</span>
<span id="cb16-6"><a href="loading-cleaning-validating-transforming.html#cb16-6" tabindex="-1"></a>          <span class="st">&quot;sac_bunt&quot;</span>,<span class="st">&quot;sac_bunt_double_play&quot;</span>,<span class="st">&quot;sac_fly&quot;</span>,<span class="st">&quot;sac_fly_double_play&quot;</span>,</span>
<span id="cb16-7"><a href="loading-cleaning-validating-transforming.html#cb16-7" tabindex="-1"></a>          <span class="st">&quot;strikeout&quot;</span>,<span class="st">&quot;strikeout_double_play&quot;</span>,<span class="st">&quot;triple_play&quot;</span>)</span>
<span id="cb16-8"><a href="loading-cleaning-validating-transforming.html#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="loading-cleaning-validating-transforming.html#cb16-9" tabindex="-1"></a>mlbraw <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="loading-cleaning-validating-transforming.html#cb16-10" tabindex="-1"></a>  <span class="fu">select</span>(events) <span class="sc">%&gt;%</span></span>
<span id="cb16-11"><a href="loading-cleaning-validating-transforming.html#cb16-11" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(events <span class="sc">%in%</span> non_outs)) <span class="sc">%&gt;%</span></span>
<span id="cb16-12"><a href="loading-cleaning-validating-transforming.html#cb16-12" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(events <span class="sc">%in%</span> outs)) <span class="co"># shouldn&#39;t return any records</span></span></code></pre></div>
<pre><code>## # A tibble: 0 × 1
## # ℹ 1 variable: events &lt;chr&gt;</code></pre>
<p>I’ll assign the value <strong>out</strong> to all the different events resulting in an out rather than using their description. Limiting the possible event values will be essential for the steps going forward.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="loading-cleaning-validating-transforming.html#cb18-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">events =</span> <span class="fu">if_else</span>(events <span class="sc">%in%</span> outs, <span class="st">&quot;out&quot;</span>, events))</span></code></pre></div>
<p>Reorder the factor levels for plotting purposes.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="loading-cleaning-validating-transforming.html#cb19-1" tabindex="-1"></a>mlbraw<span class="sc">$</span>events <span class="ot">&lt;-</span><span class="fu">factor</span>(mlbraw<span class="sc">$</span>events, </span>
<span id="cb19-2"><a href="loading-cleaning-validating-transforming.html#cb19-2" tabindex="-1"></a>                       <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;strike&quot;</span>,<span class="st">&quot;foul&quot;</span>,<span class="st">&quot;ball&quot;</span>,<span class="st">&quot;walk&quot;</span>,<span class="st">&quot;hit_by_pitch&quot;</span>,</span>
<span id="cb19-3"><a href="loading-cleaning-validating-transforming.html#cb19-3" tabindex="-1"></a>                                <span class="st">&quot;out&quot;</span>,<span class="st">&quot;single&quot;</span>,<span class="st">&quot;double&quot;</span>,<span class="st">&quot;triple&quot;</span>,<span class="st">&quot;hr&quot;</span>))</span></code></pre></div>
</div>
<div id="event-outcome-frequency-by-count" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> Event Outcome Frequency by Count<a href="loading-cleaning-validating-transforming.html#event-outcome-frequency-by-count" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="loading-cleaning-validating-transforming.html#cb20-1" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(count,events) <span class="sc">%&gt;%</span> <span class="fu">count</span>(),</span>
<span id="cb20-2"><a href="loading-cleaning-validating-transforming.html#cb20-2" tabindex="-1"></a>                   mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(count) <span class="sc">%&gt;%</span> <span class="fu">count</span>(),</span>
<span id="cb20-3"><a href="loading-cleaning-validating-transforming.html#cb20-3" tabindex="-1"></a>                   <span class="fu">join_by</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="loading-cleaning-validating-transforming.html#cb20-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> n.x <span class="sc">/</span> n.y) <span class="sc">%&gt;%</span></span>
<span id="cb20-5"><a href="loading-cleaning-validating-transforming.html#cb20-5" tabindex="-1"></a>  <span class="fu">select</span>(count, events, p) <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="loading-cleaning-validating-transforming.html#cb20-6" tabindex="-1"></a>  <span class="fu">filter</span>(events <span class="sc">!=</span> <span class="st">&quot;hit_by_pitch&quot;</span>)</span>
<span id="cb20-7"><a href="loading-cleaning-validating-transforming.html#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="loading-cleaning-validating-transforming.html#cb20-8" tabindex="-1"></a><span class="fu">ggplot</span>(plot4)<span class="sc">+</span></span>
<span id="cb20-9"><a href="loading-cleaning-validating-transforming.html#cb20-9" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>events, <span class="at">y=</span>p), </span>
<span id="cb20-10"><a href="loading-cleaning-validating-transforming.html#cb20-10" tabindex="-1"></a>           <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>,<span class="at">width=</span><span class="fl">0.9</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb20-11"><a href="loading-cleaning-validating-transforming.html#cb20-11" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>, <span class="at">linewidth=</span><span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb20-12"><a href="loading-cleaning-validating-transforming.html#cb20-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb20-13"><a href="loading-cleaning-validating-transforming.html#cb20-13" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.63</span>)<span class="sc">+</span></span>
<span id="cb20-14"><a href="loading-cleaning-validating-transforming.html#cb20-14" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>count, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">nrow=</span><span class="dv">4</span>, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb20-15"><a href="loading-cleaning-validating-transforming.html#cb20-15" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Event Outcome Frequency by Count </span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">+</span></span>
<span id="cb20-16"><a href="loading-cleaning-validating-transforming.html#cb20-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>),</span>
<span id="cb20-17"><a href="loading-cleaning-validating-transforming.html#cb20-17" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb20-18"><a href="loading-cleaning-validating-transforming.html#cb20-18" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb20-19"><a href="loading-cleaning-validating-transforming.html#cb20-19" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb20-20"><a href="loading-cleaning-validating-transforming.html#cb20-20" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">14</span>,<span class="at">color=</span><span class="st">&quot;grey40&quot;</span>),</span>
<span id="cb20-21"><a href="loading-cleaning-validating-transforming.html#cb20-21" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-22"><a href="loading-cleaning-validating-transforming.html#cb20-22" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb20-23"><a href="loading-cleaning-validating-transforming.html#cb20-23" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb20-24"><a href="loading-cleaning-validating-transforming.html#cb20-24" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/event%20outcome%20frequency%20by%20count-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
<p>The plot above breaks down the frequency of events in different batter counts, specifically when the events have been narrowed down to 10 values. A pitcher is much more likely to throw a strike in a 3-0 count than a 0-0 count or 0-2 count. And is much more likely to record an out in two-strike counts than no-strike or one-strike counts. Glancing over the plot, the results appear to be what I’d expect which gives some validation to the contents of the data set.</p>
</div>
<div id="average-delta-run-expectancy" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> Average Delta Run Expectancy<a href="loading-cleaning-validating-transforming.html#average-delta-run-expectancy" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The purpose of this project is to quantify how good or bad a pitch location is based on the pitch type, count, handedness of the pitch and batter, and of course the location of the pitch on x and y plane. But what metric should be used quantify and formulate the results.</p>
<p>The column <strong>delta_run_exp</strong> exists in the data frame that specifies the value of that individual event in terms of <em>how the run expectancy changed based on that individual event</em>. Every fixed situation in a game has an run expectancy based on where base runners are located prior to the pitch, number of outs prior to the pitch, and the batter count prior to the pitch.</p>
<p>Let’s look at an example scenario. An at-bat begins with 0 outs and runners on 1st and 2nd starting in a 0-0 count. In this particular state there is an expected number of runs scored for the remainder of the inning based on those parameters. In 2023, on average 1.465 runs scored in the remainder of the inning for that specific scenario.</p>
<p>If the first pitch thrown in the at-bat is a strike, we have a new scenario with a different expected runs scored for the remainder of the inning. Now there are 0 outs with runners on 1st and 2nd in a 0-1 count. And now the average runs scored for the remained of the inning is slightly different than before: 1.376.</p>
<p>So the strike thrown by the pitcher changed the expected runs scored by -0.089 and will display that vlaue in the <strong>delta_run_exp</strong> column. Every pitch in a baseball game can be evaluated by comparing the expected runs prior to the pitch thrown to the expected runs after the pitch is thrown.</p>
<p>This appears to be best measure available to apply to my location quality metric using the delta_run_exp value to quality the result of any pitch. The only problem is that delta_run_exp derives it’s value from: <strong>count</strong>, <strong>outs</strong>, <strong>base runners</strong>, and resulting <strong>event</strong>. In my project I aim to evaluate pitches on different conditions. Really, I am just looking for the average change in run expectancy based on the <strong>count</strong> and <strong>event</strong>. So the goal here is to transform the existing data set so rather than relying on <strong>delta_run_exp</strong> as our metric of success/fail, we create a new variable that gives a change in run expectancy based on the parameters we have set for this project. So when a specific event takes place (ball, strike, double, fielders choice etc.) in a specific count (0-1, 2-0, 3-2 etc.) we have the average change in run expectancy.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="loading-cleaning-validating-transforming.html#cb21-1" tabindex="-1"></a>re_outs <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb21-2"><a href="loading-cleaning-validating-transforming.html#cb21-2" tabindex="-1"></a>  <span class="fu">filter</span>(events <span class="sc">==</span> <span class="st">&quot;out&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="loading-cleaning-validating-transforming.html#cb21-3" tabindex="-1"></a>  <span class="fu">group_by</span>(count, events) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="loading-cleaning-validating-transforming.html#cb21-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">re =</span> <span class="fu">round</span>(<span class="fu">mean</span>(delta_run_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">4</span>), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb21-5"><a href="loading-cleaning-validating-transforming.html#cb21-5" tabindex="-1"></a></span>
<span id="cb21-6"><a href="loading-cleaning-validating-transforming.html#cb21-6" tabindex="-1"></a>re_non_outs <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb21-7"><a href="loading-cleaning-validating-transforming.html#cb21-7" tabindex="-1"></a>  <span class="fu">filter</span>(events <span class="sc">%in%</span> non_outs) <span class="sc">%&gt;%</span> </span>
<span id="cb21-8"><a href="loading-cleaning-validating-transforming.html#cb21-8" tabindex="-1"></a>  <span class="fu">group_by</span>(count, events) <span class="sc">%&gt;%</span>  </span>
<span id="cb21-9"><a href="loading-cleaning-validating-transforming.html#cb21-9" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">re =</span> <span class="fu">round</span>(<span class="fu">mean</span>(delta_run_exp, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">4</span>), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb21-10"><a href="loading-cleaning-validating-transforming.html#cb21-10" tabindex="-1"></a></span>
<span id="cb21-11"><a href="loading-cleaning-validating-transforming.html#cb21-11" tabindex="-1"></a>re_lookup <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(re_outs, re_non_outs) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(count, events)</span>
<span id="cb21-12"><a href="loading-cleaning-validating-transforming.html#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="loading-cleaning-validating-transforming.html#cb21-13" tabindex="-1"></a><span class="fu">rm</span>(outs, non_outs, re_outs, re_non_outs)</span></code></pre></div>
<p>Treat every event that resulted in an out as a single out event (regardless of the type of out or how many outs resulted in the play), this is meant to neutralize the affect base runners have on the changing run expectancy as well as the effect of number of outs.</p>
<p>I’ve separated outs from non_outs and aggregated to find the average change in run expectancy for every possible event in every possible count.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="loading-cleaning-validating-transforming.html#cb22-1" tabindex="-1"></a><span class="fu">anti_join</span>(mlbraw <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(count, events),</span>
<span id="cb22-2"><a href="loading-cleaning-validating-transforming.html#cb22-2" tabindex="-1"></a>          re_lookup <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(count, events),</span>
<span id="cb22-3"><a href="loading-cleaning-validating-transforming.html#cb22-3" tabindex="-1"></a>          <span class="fu">join_by</span>(count, events))</span></code></pre></div>
<pre><code>## # A tibble: 0 × 2
## # ℹ 2 variables: count &lt;fct&gt;, events &lt;fct&gt;</code></pre>
<p>With the clean <em>mlbraw</em> data set and linear weights look up table, we check to if any combination of count and events from the two data sets are not compatible No combination of count and events exist in one table that is not in the other.</p>
<p>Finally, if a pitch resulted in a hit by pitch I’ve decided to treat the event as if it were a ball. And in effect, take the change in run expectancy from <em>ball</em> rather than <em>hit_by_pitch</em>. This leads to more continuity between location plots where rare <em>hit_by_pitch</em> events aren’t strongly influencing certain locations and throwing off the remaining areas.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="loading-cleaning-validating-transforming.html#cb24-1" tabindex="-1"></a>mlbraw_a <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb24-2"><a href="loading-cleaning-validating-transforming.html#cb24-2" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;0-0&quot;</span>,<span class="st">&quot;0-1&quot;</span>,<span class="st">&quot;1-0&quot;</span>,<span class="st">&quot;1-1&quot;</span>,<span class="st">&quot;2-0&quot;</span>,<span class="st">&quot;2-1&quot;</span>,<span class="st">&quot;0-2&quot;</span>,<span class="st">&quot;1-2&quot;</span>,<span class="st">&quot;2-2&quot;</span>))</span>
<span id="cb24-3"><a href="loading-cleaning-validating-transforming.html#cb24-3" tabindex="-1"></a></span>
<span id="cb24-4"><a href="loading-cleaning-validating-transforming.html#cb24-4" tabindex="-1"></a>mlbraw_b <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb24-5"><a href="loading-cleaning-validating-transforming.html#cb24-5" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;3-0&quot;</span>,<span class="st">&quot;3-1&quot;</span>,<span class="st">&quot;3-2&quot;</span>))</span>
<span id="cb24-6"><a href="loading-cleaning-validating-transforming.html#cb24-6" tabindex="-1"></a></span>
<span id="cb24-7"><a href="loading-cleaning-validating-transforming.html#cb24-7" tabindex="-1"></a>mlbraw_a <span class="ot">&lt;-</span> mlbraw_a <span class="sc">%&gt;%</span> </span>
<span id="cb24-8"><a href="loading-cleaning-validating-transforming.html#cb24-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">events =</span> <span class="fu">if_else</span>(events <span class="sc">==</span> <span class="st">&quot;hit_by_pitch&quot;</span>, <span class="st">&quot;ball&quot;</span>, events))</span>
<span id="cb24-9"><a href="loading-cleaning-validating-transforming.html#cb24-9" tabindex="-1"></a></span>
<span id="cb24-10"><a href="loading-cleaning-validating-transforming.html#cb24-10" tabindex="-1"></a>mlbraw_b <span class="ot">&lt;-</span> mlbraw_b <span class="sc">%&gt;%</span> </span>
<span id="cb24-11"><a href="loading-cleaning-validating-transforming.html#cb24-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">events =</span> <span class="fu">if_else</span>(events <span class="sc">==</span> <span class="st">&quot;hit_by_pitch&quot;</span>, <span class="st">&quot;walk&quot;</span>, events))</span>
<span id="cb24-12"><a href="loading-cleaning-validating-transforming.html#cb24-12" tabindex="-1"></a></span>
<span id="cb24-13"><a href="loading-cleaning-validating-transforming.html#cb24-13" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw_a, mlbraw_b) <span class="sc">%&gt;%</span> </span>
<span id="cb24-14"><a href="loading-cleaning-validating-transforming.html#cb24-14" tabindex="-1"></a>  <span class="fu">arrange</span>(game_year, count, events)</span>
<span id="cb24-15"><a href="loading-cleaning-validating-transforming.html#cb24-15" tabindex="-1"></a></span>
<span id="cb24-16"><a href="loading-cleaning-validating-transforming.html#cb24-16" tabindex="-1"></a><span class="fu">rm</span>(mlbraw_a, mlbraw_b)</span></code></pre></div>
</div>
<div id="join-lookup-table-to-data-set" class="section level2 hasAnchor" number="2.8">
<h2><span class="header-section-number">2.8</span> Join Lookup Table to Data Set<a href="loading-cleaning-validating-transforming.html#join-lookup-table-to-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now I’ll take the main data set with the past 10 years worth of pitches and join the look up table to it, essentially replacing the <em>delta_run_exp</em> values with my new average change in run expectancy values.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="loading-cleaning-validating-transforming.html#cb25-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> </span>
<span id="cb25-2"><a href="loading-cleaning-validating-transforming.html#cb25-2" tabindex="-1"></a>  <span class="fu">left_join</span>(re_lookup, <span class="fu">join_by</span>(count, events)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>delta_run_exp)</span></code></pre></div>
<p>Here is an overview of how each event in each count impacts run expectancy. We now have a specific change in run expectancy value for every combination of count and events.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="loading-cleaning-validating-transforming.html#cb26-1" tabindex="-1"></a>plot5 <span class="ot">&lt;-</span> re_lookup <span class="sc">%&gt;%</span> <span class="fu">filter</span>(events <span class="sc">!=</span> <span class="st">&quot;hit_by_pitch&quot;</span>)</span>
<span id="cb26-2"><a href="loading-cleaning-validating-transforming.html#cb26-2" tabindex="-1"></a></span>
<span id="cb26-3"><a href="loading-cleaning-validating-transforming.html#cb26-3" tabindex="-1"></a>plot5<span class="sc">$</span>events <span class="ot">&lt;-</span><span class="fu">factor</span>(plot5<span class="sc">$</span>events, </span>
<span id="cb26-4"><a href="loading-cleaning-validating-transforming.html#cb26-4" tabindex="-1"></a>                      <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;out&quot;</span>,<span class="st">&quot;strike&quot;</span>,<span class="st">&quot;foul&quot;</span>,<span class="st">&quot;ball&quot;</span>,<span class="st">&quot;walk&quot;</span>,</span>
<span id="cb26-5"><a href="loading-cleaning-validating-transforming.html#cb26-5" tabindex="-1"></a>                               <span class="st">&quot;single&quot;</span>,<span class="st">&quot;double&quot;</span>,<span class="st">&quot;triple&quot;</span>,<span class="st">&quot;hr&quot;</span>))</span>
<span id="cb26-6"><a href="loading-cleaning-validating-transforming.html#cb26-6" tabindex="-1"></a></span>
<span id="cb26-7"><a href="loading-cleaning-validating-transforming.html#cb26-7" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot5, <span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">y=</span>events, <span class="at">fill=</span>re))<span class="sc">+</span></span>
<span id="cb26-8"><a href="loading-cleaning-validating-transforming.html#cb26-8" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb26-9"><a href="loading-cleaning-validating-transforming.html#cb26-9" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>count, <span class="at">y=</span>events, <span class="at">label=</span><span class="fu">round</span>(re,<span class="dv">2</span>)), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb26-10"><a href="loading-cleaning-validating-transforming.html#cb26-10" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Average Change in Run Expenctancy Based on Count and Events </span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">+</span></span>
<span id="cb26-11"><a href="loading-cleaning-validating-transforming.html#cb26-11" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">high=</span><span class="st">&quot;red&quot;</span>, <span class="at">mid=</span><span class="st">&quot;white&quot;</span>, <span class="at">low=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb26-12"><a href="loading-cleaning-validating-transforming.html#cb26-12" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span> </span>
<span id="cb26-13"><a href="loading-cleaning-validating-transforming.html#cb26-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb26-14"><a href="loading-cleaning-validating-transforming.html#cb26-14" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.9</span>),</span>
<span id="cb26-15"><a href="loading-cleaning-validating-transforming.html#cb26-15" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb26-16"><a href="loading-cleaning-validating-transforming.html#cb26-16" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/Average%20Change%20in%20Run%20Expenctancy%20Based%20on%20Count%20and%20Events-1.png" width="1152" style="display: block; margin: auto auto auto 0;" /></p>
<p>As you might expect, event outcomes have slightly different run expectancy changes depending on the count. A home run hit in an 0-2 count has more added run value than a home run hit in a 3-0 count. This is because an 0-2 count is already a more favorable position for the pitcher to be in than a 3-0 count, with the run expectancy starting out lower before the home run is hit.</p>
<p>Similarly, an out recorded in an 3-0 count is considerably more favorable to the pitcher than an out recorded in a 0-2 count. This makes logical sense to any baseball enthusiast.</p>
<p>Thankfully, when comparing average change in run expectancy values by count we’re not seeing any drastic difference from one grouping to the other. And all the values appear to make a great deal of baseball sense.</p>
</div>
<div id="addressing-pitch-types" class="section level2 hasAnchor" number="2.9">
<h2><span class="header-section-number">2.9</span> Addressing Pitch Types<a href="loading-cleaning-validating-transforming.html#addressing-pitch-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So far in the cleaning process, we’ve avoided the pitch_type column. Here’s an overview at the pitch types make up a data set containing all pitches thrown the last 10 years in all MLB regular season game.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="loading-cleaning-validating-transforming.html#cb27-1" tabindex="-1"></a>plot6 <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pitch_type, pitch_name) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb27-2"><a href="loading-cleaning-validating-transforming.html#cb27-2" tabindex="-1"></a></span>
<span id="cb27-3"><a href="loading-cleaning-validating-transforming.html#cb27-3" tabindex="-1"></a><span class="fu">ggplot</span>(plot6, <span class="fu">aes</span>(<span class="at">x=</span>n, <span class="at">y=</span><span class="fu">reorder</span>(pitch_name, n)))<span class="sc">+</span></span>
<span id="cb27-4"><a href="loading-cleaning-validating-transforming.html#cb27-4" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;steelblue3&quot;</span>)<span class="sc">+</span></span>
<span id="cb27-5"><a href="loading-cleaning-validating-transforming.html#cb27-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> n), <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>, <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb27-6"><a href="loading-cleaning-validating-transforming.html#cb27-6" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Count of Observations by Pitch Type </span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">+</span></span>
<span id="cb27-7"><a href="loading-cleaning-validating-transforming.html#cb27-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb27-8"><a href="loading-cleaning-validating-transforming.html#cb27-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>),</span>
<span id="cb27-9"><a href="loading-cleaning-validating-transforming.html#cb27-9" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb27-10"><a href="loading-cleaning-validating-transforming.html#cb27-10" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-11"><a href="loading-cleaning-validating-transforming.html#cb27-11" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb27-12"><a href="loading-cleaning-validating-transforming.html#cb27-12" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-13"><a href="loading-cleaning-validating-transforming.html#cb27-13" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-14"><a href="loading-cleaning-validating-transforming.html#cb27-14" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb27-15"><a href="loading-cleaning-validating-transforming.html#cb27-15" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb27-16"><a href="loading-cleaning-validating-transforming.html#cb27-16" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb27-17"><a href="loading-cleaning-validating-transforming.html#cb27-17" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">2500000</span>)<span class="sc">+</span></span>
<span id="cb27-18"><a href="loading-cleaning-validating-transforming.html#cb27-18" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-54-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
<p>4-Seam Fastballs make up a major chunk of the data set. Sinkers, Sliders, Changeups, Curveballs, and cutters are well accounted for but a significant drop off in observations occurs for the remaining pitch types. For now, we will need to transform some of the pitch types.</p>
<p>Some of the pitch type values are variations of Curveballs including: Knuckle Curves, Slow Curves, and Slurves. These pitch types do have their own distinct qualities and hand grip, but these are minor variations on the standard Curveball, especially when compared to other pitches. I’ll transform these Curveball variations so they take the standard Curveball pitch type value.</p>
<p>Some pitch types are so rare compared to the 6 or so most commonly thrown pitches that for the purpose of this project they can be eliminated going forward. Screwballs, forkballs, euphus’, other will be removed.</p>
<p>And Pitch Outs are not considered competitive pitches so they will be removed.</p>
<p>Sweepers are a somewhat new pitch type gaining popularity and usage especially within the past year. They are similar to sliders in their movement but tend to have more horizontal break and less vertical break, and tend to have less velocity than sliders. Much debate has been made whether sweepers should be considering their own designated pitch type or as a variation of the slider. For purposes of this project due to the minimal observations, I will transform sweepers into sliders.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="loading-cleaning-validating-transforming.html#cb28-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pitch_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;FF&quot;</span>,<span class="st">&quot;CU&quot;</span>,<span class="st">&quot;SL&quot;</span>,<span class="st">&quot;SI&quot;</span>,<span class="st">&quot;CH&quot;</span>,<span class="st">&quot;FS&quot;</span>,</span>
<span id="cb28-2"><a href="loading-cleaning-validating-transforming.html#cb28-2" tabindex="-1"></a>                                              <span class="st">&quot;FC&quot;</span>,<span class="st">&quot;KC&quot;</span>,<span class="st">&quot;ST&quot;</span>,<span class="st">&quot;CS&quot;</span>,<span class="st">&quot;SV&quot;</span>))</span>
<span id="cb28-3"><a href="loading-cleaning-validating-transforming.html#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="loading-cleaning-validating-transforming.html#cb28-4" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span></span>
<span id="cb28-5"><a href="loading-cleaning-validating-transforming.html#cb28-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pitch_type =</span> <span class="fu">if_else</span>(pitch_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;CU&quot;</span>,<span class="st">&quot;CS&quot;</span>,<span class="st">&quot;KC&quot;</span>, <span class="st">&quot;SV&quot;</span>), <span class="st">&quot;CU&quot;</span>,</span>
<span id="cb28-6"><a href="loading-cleaning-validating-transforming.html#cb28-6" tabindex="-1"></a>                              <span class="fu">if_else</span>(pitch_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;CH&quot;</span>,<span class="st">&quot;FS&quot;</span>), <span class="st">&quot;CH&quot;</span>,</span>
<span id="cb28-7"><a href="loading-cleaning-validating-transforming.html#cb28-7" tabindex="-1"></a>                                      <span class="fu">if_else</span>(pitch_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;SL&quot;</span>,<span class="st">&quot;ST&quot;</span>), <span class="st">&quot;SL&quot;</span>,</span>
<span id="cb28-8"><a href="loading-cleaning-validating-transforming.html#cb28-8" tabindex="-1"></a>                                              pitch_type)))) <span class="sc">%&gt;%</span></span>
<span id="cb28-9"><a href="loading-cleaning-validating-transforming.html#cb28-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pitch_name =</span> <span class="fu">if_else</span>(pitch_type <span class="sc">==</span> <span class="st">&quot;CU&quot;</span>, <span class="st">&quot;Curveball&quot;</span>, pitch_name)) <span class="sc">%&gt;%</span></span>
<span id="cb28-10"><a href="loading-cleaning-validating-transforming.html#cb28-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pitch_name =</span> <span class="fu">if_else</span>(pitch_type <span class="sc">==</span> <span class="st">&quot;SL&quot;</span>, <span class="st">&quot;Slider&quot;</span>, pitch_name)) <span class="sc">%&gt;%</span></span>
<span id="cb28-11"><a href="loading-cleaning-validating-transforming.html#cb28-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pitch_name =</span> <span class="fu">if_else</span>(pitch_type <span class="sc">==</span> <span class="st">&quot;CH&quot;</span>, <span class="st">&quot;Changeup&quot;</span>, pitch_name))</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="loading-cleaning-validating-transforming.html#cb29-1" tabindex="-1"></a>plot7 <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pitch_name) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">s=</span><span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">p =</span> n<span class="sc">/</span>s)</span>
<span id="cb29-2"><a href="loading-cleaning-validating-transforming.html#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="loading-cleaning-validating-transforming.html#cb29-3" tabindex="-1"></a><span class="fu">ggplot</span>(plot7, <span class="fu">aes</span>(<span class="at">x=</span>p, <span class="at">y=</span><span class="fu">reorder</span>(pitch_name, p), <span class="at">label=</span>p))<span class="sc">+</span></span>
<span id="cb29-4"><a href="loading-cleaning-validating-transforming.html#cb29-4" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill=</span><span class="st">&quot;steelblue3&quot;</span>)<span class="sc">+</span></span>
<span id="cb29-5"><a href="loading-cleaning-validating-transforming.html#cb29-5" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">round</span>(p,<span class="dv">2</span>), <span class="st">&quot;%&quot;</span>, <span class="at">sep=</span><span class="st">&quot;&quot;</span>)),</span>
<span id="cb29-6"><a href="loading-cleaning-validating-transforming.html#cb29-6" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.1</span>, <span class="at">size=</span><span class="dv">4</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fontface=</span><span class="st">&quot;bold&quot;</span>)<span class="sc">+</span></span>
<span id="cb29-7"><a href="loading-cleaning-validating-transforming.html#cb29-7" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Updated Count of Observations by Pitch Type </span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">+</span></span>
<span id="cb29-8"><a href="loading-cleaning-validating-transforming.html#cb29-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb29-9"><a href="loading-cleaning-validating-transforming.html#cb29-9" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>),</span>
<span id="cb29-10"><a href="loading-cleaning-validating-transforming.html#cb29-10" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb29-11"><a href="loading-cleaning-validating-transforming.html#cb29-11" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-12"><a href="loading-cleaning-validating-transforming.html#cb29-12" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb29-13"><a href="loading-cleaning-validating-transforming.html#cb29-13" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-14"><a href="loading-cleaning-validating-transforming.html#cb29-14" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-15"><a href="loading-cleaning-validating-transforming.html#cb29-15" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb29-16"><a href="loading-cleaning-validating-transforming.html#cb29-16" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb29-17"><a href="loading-cleaning-validating-transforming.html#cb29-17" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb29-18"><a href="loading-cleaning-validating-transforming.html#cb29-18" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="fl">0.38</span>)<span class="sc">+</span></span>
<span id="cb29-19"><a href="loading-cleaning-validating-transforming.html#cb29-19" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-57-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
<p>This leaves me with 6 pitch types to use to build the location quality metric with. 4-Seam Fastballs are much more well represented than the remaining pitch types, so we’ll see how this impacts the results going forward.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="loading-cleaning-validating-transforming.html#cb30-1" tabindex="-1"></a>mlbraw<span class="sc">$</span>pitch_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(mlbraw<span class="sc">$</span>pitch_type, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;FF&quot;</span>,<span class="st">&quot;SI&quot;</span>,<span class="st">&quot;FC&quot;</span>,<span class="st">&quot;CH&quot;</span>,<span class="st">&quot;CU&quot;</span>,<span class="st">&quot;SL&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="loading-cleaning-validating-transforming.html#cb31-1" tabindex="-1"></a>plot8 <span class="ot">&lt;-</span> </span>
<span id="cb31-2"><a href="loading-cleaning-validating-transforming.html#cb31-2" tabindex="-1"></a><span class="fu">inner_join</span>(mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pitch_type,events) <span class="sc">%&gt;%</span><span class="fu">count</span>(),</span>
<span id="cb31-3"><a href="loading-cleaning-validating-transforming.html#cb31-3" tabindex="-1"></a>           mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pitch_type) <span class="sc">%&gt;%</span> <span class="fu">count</span>(),</span>
<span id="cb31-4"><a href="loading-cleaning-validating-transforming.html#cb31-4" tabindex="-1"></a>           <span class="fu">join_by</span>(pitch_type)) <span class="sc">%&gt;%</span></span>
<span id="cb31-5"><a href="loading-cleaning-validating-transforming.html#cb31-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> n.x <span class="sc">/</span> n.y) <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="loading-cleaning-validating-transforming.html#cb31-6" tabindex="-1"></a>  <span class="fu">select</span>(pitch_type, events, p)</span>
<span id="cb31-7"><a href="loading-cleaning-validating-transforming.html#cb31-7" tabindex="-1"></a></span>
<span id="cb31-8"><a href="loading-cleaning-validating-transforming.html#cb31-8" tabindex="-1"></a>plot8<span class="sc">$</span>pitch_type <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot8<span class="sc">$</span>pitch_type, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;FF&quot;</span>,<span class="st">&quot;SI&quot;</span>,<span class="st">&quot;FC&quot;</span>,<span class="st">&quot;CH&quot;</span>,<span class="st">&quot;CU&quot;</span>,<span class="st">&quot;SL&quot;</span>))</span>
<span id="cb31-9"><a href="loading-cleaning-validating-transforming.html#cb31-9" tabindex="-1"></a>plot8<span class="sc">$</span>events <span class="ot">&lt;-</span> <span class="fu">factor</span>(plot8<span class="sc">$</span>events, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;strike&quot;</span>,<span class="st">&quot;foul&quot;</span>,<span class="st">&quot;ball&quot;</span>,<span class="st">&quot;walk&quot;</span>,<span class="st">&quot;hit_by_pitch&quot;</span>,</span>
<span id="cb31-10"><a href="loading-cleaning-validating-transforming.html#cb31-10" tabindex="-1"></a>                                              <span class="st">&quot;out&quot;</span>,<span class="st">&quot;single&quot;</span>,<span class="st">&quot;double&quot;</span>,<span class="st">&quot;triple&quot;</span>,<span class="st">&quot;hr&quot;</span>))</span>
<span id="cb31-11"><a href="loading-cleaning-validating-transforming.html#cb31-11" tabindex="-1"></a></span>
<span id="cb31-12"><a href="loading-cleaning-validating-transforming.html#cb31-12" tabindex="-1"></a><span class="fu">ggplot</span>(plot8)<span class="sc">+</span></span>
<span id="cb31-13"><a href="loading-cleaning-validating-transforming.html#cb31-13" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="fu">aes</span>(<span class="at">x=</span>events, <span class="at">y=</span>p), <span class="at">fill=</span><span class="st">&quot;grey&quot;</span>)<span class="sc">+</span></span>
<span id="cb31-14"><a href="loading-cleaning-validating-transforming.html#cb31-14" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Event Outcome Frequency by Pitch Type </span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">+</span></span>
<span id="cb31-15"><a href="loading-cleaning-validating-transforming.html#cb31-15" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">0.4</span>)<span class="sc">+</span></span>
<span id="cb31-16"><a href="loading-cleaning-validating-transforming.html#cb31-16" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb31-17"><a href="loading-cleaning-validating-transforming.html#cb31-17" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pitch_type, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">nrow=</span><span class="dv">3</span>, <span class="at">scales=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb31-18"><a href="loading-cleaning-validating-transforming.html#cb31-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>),</span>
<span id="cb31-19"><a href="loading-cleaning-validating-transforming.html#cb31-19" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb31-20"><a href="loading-cleaning-validating-transforming.html#cb31-20" tabindex="-1"></a>        <span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb31-21"><a href="loading-cleaning-validating-transforming.html#cb31-21" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>,</span>
<span id="cb31-22"><a href="loading-cleaning-validating-transforming.html#cb31-22" tabindex="-1"></a>                                   <span class="at">size=</span><span class="dv">14</span>,<span class="at">color=</span><span class="st">&quot;grey40&quot;</span>),</span>
<span id="cb31-23"><a href="loading-cleaning-validating-transforming.html#cb31-23" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-24"><a href="loading-cleaning-validating-transforming.html#cb31-24" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>),</span>
<span id="cb31-25"><a href="loading-cleaning-validating-transforming.html#cb31-25" tabindex="-1"></a>        <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb31-26"><a href="loading-cleaning-validating-transforming.html#cb31-26" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/event%20outcome%20frequency%20by%20pitch%20type-1.png" width="960" style="display: block; margin: auto auto auto 0;" /></p>
<p>According to the graph above, event outcomes have generally the same frequency regardless of pitch type. Pitch types like curveballs, sliders, and changeups with more movement and aggressive hand grips are thrown for balls more often than strikes, while variations of fastballs are thrown for strikes more often.</p>
</div>
<div id="cleaning-pitch-locations" class="section level2 hasAnchor" number="2.10">
<h2><span class="header-section-number">2.10</span> Cleaning Pitch Locations<a href="loading-cleaning-validating-transforming.html#cleaning-pitch-locations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Next, I’ll bring attention to the location of each pitch. <em>Plate_x</em> will take a value depending on how far away the pitch is horizontally from the center of the plate in feet If a pitch is thrown direction down the middle of the plate, its plate_x value will be 0. Home plate is 1.66 feet wide, so pitches with plate_x values ranging from -0.83 to 0.83 cross some part of the plate. Here is the distribution of plate_x values rounded up as whole number.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="loading-cleaning-validating-transforming.html#cb32-1" tabindex="-1"></a>mlbraw <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">plate_x =</span> <span class="fu">round</span>(plate_x,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="loading-cleaning-validating-transforming.html#cb32-2" tabindex="-1"></a>  <span class="fu">group_by</span>(plate_x) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(plate_x)) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="loading-cleaning-validating-transforming.html#cb32-3" tabindex="-1"></a>  <span class="fu">regulartable</span>() <span class="sc">%&gt;%</span> <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="loading-cleaning-validating-transforming.html#cb32-4" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">width=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">height</span>(<span class="at">height=</span><span class="fl">0.1</span>)</span></code></pre></div>
<div class="tabwid"><style>.cl-cf864dba{}.cl-cf829580{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-cf8417e8{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cf84206c{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf842076{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cf842080{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-cf864dba'><thead><tr style="overflow-wrap:break-word;"><th class="cl-cf84206c"><p class="cl-cf8417e8"><span class="cl-cf829580">plate_x</span></p></th><th class="cl-cf84206c"><p class="cl-cf8417e8"><span class="cl-cf829580">n</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">9</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">8</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">7</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">6</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">6</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">5</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">35</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">4</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">492</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">3</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">12,492</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">2</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">253,459</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">1</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">1,631,079</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">0</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">2,883,140</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-1</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">1,556,976</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-2</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">241,665</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-3</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">11,448</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-4</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">493</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-5</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">45</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-6</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">9</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-7</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-8</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-9</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">-10</span></p></td><td class="cl-cf842076"><p class="cl-cf8417e8"><span class="cl-cf829580">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cf842080"><p class="cl-cf8417e8"><span class="cl-cf829580">-11</span></p></td><td class="cl-cf842080"><p class="cl-cf8417e8"><span class="cl-cf829580">1</span></p></td></tr></tbody></table></div>
<p>The plate_x pitch distribution is normal with an extremely high peak at 0. Pitches thrown more than 4 inches to the right or left of the center of the strike zone are extremely rare, so much so that I imagine data entry errors could be the reason for such extreme values. Regardless I’ve chosen to narrow the data set to only include pitches with plate_x values between -4 and 4.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="loading-cleaning-validating-transforming.html#cb33-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plate_x <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">4</span>, plate_x <span class="sc">&lt;=</span> <span class="dv">4</span>)</span></code></pre></div>
<p>Turning attention to plate_z, a similar location distribution exists in the data set. The vast majority of pitches are thrown 2 or 3 feet above the ground (essentially the middle of the strike zone vertically). Pitches more than 6 feet above the ground are quite rare, as well as pitches 2 feet below the ground (bounced on before arriving). I’ll mark these heights as cutoffs and filter out pitches from the data set outside this range.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="loading-cleaning-validating-transforming.html#cb34-1" tabindex="-1"></a>mlbraw <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">plate_z =</span> <span class="fu">round</span>(plate_z,<span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="loading-cleaning-validating-transforming.html#cb34-2" tabindex="-1"></a>  <span class="fu">group_by</span>(plate_z) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(plate_z)) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="loading-cleaning-validating-transforming.html#cb34-3" tabindex="-1"></a>  <span class="fu">regulartable</span>() <span class="sc">%&gt;%</span> <span class="fu">autofit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb34-4"><a href="loading-cleaning-validating-transforming.html#cb34-4" tabindex="-1"></a>  <span class="fu">width</span>(<span class="at">j=</span><span class="sc">~</span>plate_z,<span class="at">width=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="fu">width</span>(<span class="at">j=</span><span class="sc">~</span>n,<span class="at">width=</span><span class="dv">1</span>)</span></code></pre></div>
<div class="tabwid"><style>.cl-cfc49462{}.cl-cfc14a82{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-cfc29090{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-cfc29dc4{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29dc5{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29dce{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29dcf{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29dec{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29df6{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29df7{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29df8{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29df9{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-cfc29e00{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing='true' class='cl-cfc49462'><thead><tr style="overflow-wrap:break-word;"><th class="cl-cfc29dc4"><p class="cl-cfc29090"><span class="cl-cfc14a82">plate_z</span></p></th><th class="cl-cfc29dc4"><p class="cl-cfc29090"><span class="cl-cfc14a82">n</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-cfc29dc5"><p class="cl-cfc29090"><span class="cl-cfc14a82">12</span></p></td><td class="cl-cfc29dc5"><p class="cl-cfc29090"><span class="cl-cfc14a82">1</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29dc5"><p class="cl-cfc29090"><span class="cl-cfc14a82">11</span></p></td><td class="cl-cfc29dc5"><p class="cl-cfc29090"><span class="cl-cfc14a82">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29dce"><p class="cl-cfc29090"><span class="cl-cfc14a82">10</span></p></td><td class="cl-cfc29dce"><p class="cl-cfc29090"><span class="cl-cfc14a82">2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29dcf"><p class="cl-cfc29090"><span class="cl-cfc14a82">9</span></p></td><td class="cl-cfc29dcf"><p class="cl-cfc29090"><span class="cl-cfc14a82">8</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29dcf"><p class="cl-cfc29090"><span class="cl-cfc14a82">8</span></p></td><td class="cl-cfc29dcf"><p class="cl-cfc29090"><span class="cl-cfc14a82">21</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29dcf"><p class="cl-cfc29090"><span class="cl-cfc14a82">7</span></p></td><td class="cl-cfc29dcf"><p class="cl-cfc29090"><span class="cl-cfc14a82">260</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29dec"><p class="cl-cfc29090"><span class="cl-cfc14a82">6</span></p></td><td class="cl-cfc29dec"><p class="cl-cfc29090"><span class="cl-cfc14a82">4,339</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df6"><p class="cl-cfc29090"><span class="cl-cfc14a82">5</span></p></td><td class="cl-cfc29df6"><p class="cl-cfc29090"><span class="cl-cfc14a82">61,776</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df6"><p class="cl-cfc29090"><span class="cl-cfc14a82">4</span></p></td><td class="cl-cfc29df6"><p class="cl-cfc29090"><span class="cl-cfc14a82">542,856</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df6"><p class="cl-cfc29090"><span class="cl-cfc14a82">3</span></p></td><td class="cl-cfc29df6"><p class="cl-cfc29090"><span class="cl-cfc14a82">2,002,216</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df6"><p class="cl-cfc29090"><span class="cl-cfc14a82">2</span></p></td><td class="cl-cfc29df6"><p class="cl-cfc29090"><span class="cl-cfc14a82">2,648,279</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df7"><p class="cl-cfc29090"><span class="cl-cfc14a82">1</span></p></td><td class="cl-cfc29df7"><p class="cl-cfc29090"><span class="cl-cfc14a82">1,102,790</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df7"><p class="cl-cfc29090"><span class="cl-cfc14a82">0</span></p></td><td class="cl-cfc29df7"><p class="cl-cfc29090"><span class="cl-cfc14a82">204,405</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df7"><p class="cl-cfc29090"><span class="cl-cfc14a82">-1</span></p></td><td class="cl-cfc29df7"><p class="cl-cfc29090"><span class="cl-cfc14a82">21,991</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df7"><p class="cl-cfc29090"><span class="cl-cfc14a82">-2</span></p></td><td class="cl-cfc29df7"><p class="cl-cfc29090"><span class="cl-cfc14a82">1,925</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df8"><p class="cl-cfc29090"><span class="cl-cfc14a82">-3</span></p></td><td class="cl-cfc29df8"><p class="cl-cfc29090"><span class="cl-cfc14a82">169</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29df9"><p class="cl-cfc29090"><span class="cl-cfc14a82">-4</span></p></td><td class="cl-cfc29df9"><p class="cl-cfc29090"><span class="cl-cfc14a82">19</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-cfc29e00"><p class="cl-cfc29090"><span class="cl-cfc14a82">-5</span></p></td><td class="cl-cfc29e00"><p class="cl-cfc29090"><span class="cl-cfc14a82">3</span></p></td></tr></tbody></table></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="loading-cleaning-validating-transforming.html#cb35-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(plate_z <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">2</span>, plate_z <span class="sc">&lt;=</span> <span class="dv">6</span>)</span></code></pre></div>
</div>
<div id="count-of-all-observations" class="section level2 hasAnchor" number="2.11">
<h2><span class="header-section-number">2.11</span> Count of All Observations<a href="loading-cleaning-validating-transforming.html#count-of-all-observations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The challenge moving forward is evaluating the effectiveness of a pitch’s location when some combination of pitch type, count, and handedness is rare in the data set. 4-Seam Fastballs thrown by a RHP to a RHB in a 0-0 count is by far the most common situation making up 240,591 observations of the data set. While Curveballs thrown by LHP to LHB in 3-0 counts produce only 21 observations. How can 21 observations effectively map out pitch location quality?</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="loading-cleaning-validating-transforming.html#cb36-1" tabindex="-1"></a>mlbraw <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="loading-cleaning-validating-transforming.html#cb36-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">x=</span>plate_x, <span class="at">y=</span>plate_z) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="loading-cleaning-validating-transforming.html#cb36-3" tabindex="-1"></a>  <span class="fu">select</span>(hand, pitch_type, count, events, x, y, re)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="loading-cleaning-validating-transforming.html#cb37-1" tabindex="-1"></a>plot9 <span class="ot">&lt;-</span> mlbraw <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(hand, count, pitch_type) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb37-2"><a href="loading-cleaning-validating-transforming.html#cb37-2" tabindex="-1"></a></span>
<span id="cb37-3"><a href="loading-cleaning-validating-transforming.html#cb37-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot9, <span class="fu">aes</span>(<span class="at">x=</span>pitch_type, <span class="at">y=</span>count))<span class="sc">+</span></span>
<span id="cb37-4"><a href="loading-cleaning-validating-transforming.html#cb37-4" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>n), <span class="at">alpha =</span> <span class="fl">0.5</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb37-5"><a href="loading-cleaning-validating-transforming.html#cb37-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>hand, <span class="at">scale=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb37-6"><a href="loading-cleaning-validating-transforming.html#cb37-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>pitch_type, <span class="at">y=</span>count, <span class="at">label=</span>n))<span class="sc">+</span></span>
<span id="cb37-7"><a href="loading-cleaning-validating-transforming.html#cb37-7" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb37-8"><a href="loading-cleaning-validating-transforming.html#cb37-8" tabindex="-1"></a>                       <span class="at">values =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(<span class="fu">c</span>(<span class="fu">min</span>(plot9<span class="sc">$</span>n), </span>
<span id="cb37-9"><a href="loading-cleaning-validating-transforming.html#cb37-9" tabindex="-1"></a>                                                  <span class="fu">quantile</span>(plot9<span class="sc">$</span>n, <span class="fl">0.1</span>),</span>
<span id="cb37-10"><a href="loading-cleaning-validating-transforming.html#cb37-10" tabindex="-1"></a>                                                  <span class="fu">max</span>(plot9<span class="sc">$</span>n))),</span>
<span id="cb37-11"><a href="loading-cleaning-validating-transforming.html#cb37-11" tabindex="-1"></a>                       <span class="at">guide=</span><span class="st">&quot;colorbar&quot;</span>) <span class="sc">+</span></span>
<span id="cb37-12"><a href="loading-cleaning-validating-transforming.html#cb37-12" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span> </span>
<span id="cb37-13"><a href="loading-cleaning-validating-transforming.html#cb37-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb37-14"><a href="loading-cleaning-validating-transforming.html#cb37-14" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.9</span>),</span>
<span id="cb37-15"><a href="loading-cleaning-validating-transforming.html#cb37-15" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/heatmap%20of%20all%20observations-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>To work around this challenge, I’ve decided to essentially double the data set. All pitches thrown by RHP to RHB will also include all pitches thrown by LHP to LHB with hand label <em>LvL</em> changed to <em>RvR.</em> The added data will have opposite plate_x values. So a pitch thrown by LHP to LHB with a plate_x of 1 and plate_z of 4 will be added as a pitch thrown by RHP to RHB with a plate_x of -1 and plate_z of 4. This mutation of data doubles the number of observations in the main data set.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="loading-cleaning-validating-transforming.html#cb38-1" tabindex="-1"></a>mlbraw_r_r <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;RvR&quot;</span>),</span>
<span id="cb38-2"><a href="loading-cleaning-validating-transforming.html#cb38-2" tabindex="-1"></a>mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;LvL&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-3"><a href="loading-cleaning-validating-transforming.html#cb38-3" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">x =</span> x<span class="sc">*-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-4"><a href="loading-cleaning-validating-transforming.html#cb38-4" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">hand =</span> <span class="st">&quot;RvR&quot;</span>))</span>
<span id="cb38-5"><a href="loading-cleaning-validating-transforming.html#cb38-5" tabindex="-1"></a></span>
<span id="cb38-6"><a href="loading-cleaning-validating-transforming.html#cb38-6" tabindex="-1"></a>mlbraw_l_l <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;LvL&quot;</span>),</span>
<span id="cb38-7"><a href="loading-cleaning-validating-transforming.html#cb38-7" tabindex="-1"></a>mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;RvR&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="loading-cleaning-validating-transforming.html#cb38-8" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">x =</span> x<span class="sc">*-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="loading-cleaning-validating-transforming.html#cb38-9" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">hand =</span> <span class="st">&quot;LvL&quot;</span>))</span>
<span id="cb38-10"><a href="loading-cleaning-validating-transforming.html#cb38-10" tabindex="-1"></a></span>
<span id="cb38-11"><a href="loading-cleaning-validating-transforming.html#cb38-11" tabindex="-1"></a>mlbraw_r_l <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;RvL&quot;</span>),</span>
<span id="cb38-12"><a href="loading-cleaning-validating-transforming.html#cb38-12" tabindex="-1"></a>mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;LvR&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-13"><a href="loading-cleaning-validating-transforming.html#cb38-13" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">x =</span> x<span class="sc">*-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-14"><a href="loading-cleaning-validating-transforming.html#cb38-14" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">hand =</span> <span class="st">&quot;RvL&quot;</span>))</span>
<span id="cb38-15"><a href="loading-cleaning-validating-transforming.html#cb38-15" tabindex="-1"></a></span>
<span id="cb38-16"><a href="loading-cleaning-validating-transforming.html#cb38-16" tabindex="-1"></a>mlbraw_l_r <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;LvR&quot;</span>),</span>
<span id="cb38-17"><a href="loading-cleaning-validating-transforming.html#cb38-17" tabindex="-1"></a>mlbraw <span class="sc">%&gt;%</span> <span class="fu">filter</span>(hand <span class="sc">==</span> <span class="st">&quot;RvL&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-18"><a href="loading-cleaning-validating-transforming.html#cb38-18" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">x =</span> x<span class="sc">*-</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-19"><a href="loading-cleaning-validating-transforming.html#cb38-19" tabindex="-1"></a><span class="fu">mutate</span>(<span class="at">hand =</span> <span class="st">&quot;LvR&quot;</span>))</span>
<span id="cb38-20"><a href="loading-cleaning-validating-transforming.html#cb38-20" tabindex="-1"></a></span>
<span id="cb38-21"><a href="loading-cleaning-validating-transforming.html#cb38-21" tabindex="-1"></a>mlbraw2 <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(mlbraw_r_r, mlbraw_l_l,</span>
<span id="cb38-22"><a href="loading-cleaning-validating-transforming.html#cb38-22" tabindex="-1"></a>mlbraw_r_l, mlbraw_l_r)</span>
<span id="cb38-23"><a href="loading-cleaning-validating-transforming.html#cb38-23" tabindex="-1"></a></span>
<span id="cb38-24"><a href="loading-cleaning-validating-transforming.html#cb38-24" tabindex="-1"></a><span class="fu">rm</span>(mlbraw_r_r, mlbraw_l_l, mlbraw_r_l, mlbraw_l_r, mlbraw)</span></code></pre></div>
<p>The same heatmap now shows double the number of observations for each combination of handedness, pitch type, and count. Some combinations still have low number of observations but it’s an improvement over the previous data set before doubling up.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="loading-cleaning-validating-transforming.html#cb39-1" tabindex="-1"></a>plot10 <span class="ot">&lt;-</span> mlbraw2 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(hand, count, pitch_type) <span class="sc">%&gt;%</span> <span class="fu">count</span>() <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb39-2"><a href="loading-cleaning-validating-transforming.html#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="loading-cleaning-validating-transforming.html#cb39-3" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> plot10, <span class="fu">aes</span>(<span class="at">x=</span>pitch_type, <span class="at">y=</span>count))<span class="sc">+</span></span>
<span id="cb39-4"><a href="loading-cleaning-validating-transforming.html#cb39-4" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>n), <span class="at">alpha =</span> <span class="fl">0.5</span>,<span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb39-5"><a href="loading-cleaning-validating-transforming.html#cb39-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>hand, <span class="at">scale=</span><span class="st">&quot;free&quot;</span>)<span class="sc">+</span></span>
<span id="cb39-6"><a href="loading-cleaning-validating-transforming.html#cb39-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">x=</span>pitch_type, <span class="at">y=</span>count, <span class="at">label=</span>n))<span class="sc">+</span></span>
<span id="cb39-7"><a href="loading-cleaning-validating-transforming.html#cb39-7" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;white&quot;</span>,<span class="st">&quot;red&quot;</span>),</span>
<span id="cb39-8"><a href="loading-cleaning-validating-transforming.html#cb39-8" tabindex="-1"></a>                       <span class="at">values =</span> scales<span class="sc">::</span><span class="fu">rescale</span>(<span class="fu">c</span>(<span class="fu">min</span>(plot10<span class="sc">$</span>n), </span>
<span id="cb39-9"><a href="loading-cleaning-validating-transforming.html#cb39-9" tabindex="-1"></a>                                                  <span class="fu">quantile</span>(plot10<span class="sc">$</span>n, <span class="fl">0.1</span>),</span>
<span id="cb39-10"><a href="loading-cleaning-validating-transforming.html#cb39-10" tabindex="-1"></a>                                                  <span class="fu">max</span>(plot10<span class="sc">$</span>n))),</span>
<span id="cb39-11"><a href="loading-cleaning-validating-transforming.html#cb39-11" tabindex="-1"></a>                       <span class="at">guide=</span><span class="st">&quot;colorbar&quot;</span>) <span class="sc">+</span></span>
<span id="cb39-12"><a href="loading-cleaning-validating-transforming.html#cb39-12" tabindex="-1"></a>  <span class="fu">theme_void</span>()<span class="sc">+</span> </span>
<span id="cb39-13"><a href="loading-cleaning-validating-transforming.html#cb39-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">8</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb39-14"><a href="loading-cleaning-validating-transforming.html#cb39-14" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">hjust =</span> <span class="fl">0.9</span>),</span>
<span id="cb39-15"><a href="loading-cleaning-validating-transforming.html#cb39-15" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">20</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/heatmap%20of%20all%20observations2-1.png" width="1152" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="example-model.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/drose1988/pitch_location_quality_project/edit/main/02-loading_cleaning_validating_transforming.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/drose1988/pitch_location_quality_project/blob/main/02-loading_cleaning_validating_transforming.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
